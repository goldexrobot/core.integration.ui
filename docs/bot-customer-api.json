{"components":{"requestBodies":{"EmptyRequest":{"content":{"application/json":{"schema":{"type":"object","x-go-type":"struct{}"}}},"description":"Empty params"}},"responses":{"EmptyResult":{"content":{"application/json":{"schema":{"type":"object","x-go-type":"struct{}"}}},"description":"Empty result"}},"schemas":{"DispenserExtractRequest":{"properties":{"steps":{"description":"List of the dispenser slots to push","items":{"$ref":"#/components/schemas/DispenserExtractionStep"},"type":"array","x-oapi-codegen-extra-tags":{"validate":"required,min=1,unique=Slot"}}},"required":["steps"],"type":"object"},"DispenserExtractResult":{"properties":{"hardware_failed":{"description":"In case of hardware failure this flag is set. You should complete current customer session and call `service.kill` method.\n\nAt this point any calls to the API methods are forbidden (except `hardware.*`).\n\nThe purpose of this workaround is to protect the hardware from a damage, while still allowing the business logic to remain intact.\n\nOn a failure, there is no guarantee that the item has been moved, but the business flow must complete for sake of data consistency. \n\nOne way or another, the item will be moved by technical support team.","example":false,"type":"boolean"}},"required":["hardware_failed"],"type":"object"},"DispenserExtractionStep":{"description":"Which slot and how many times to push","properties":{"slot":{"$ref":"#/components/schemas/DispenserSlot"},"times":{"example":42,"minimum":1,"type":"integer","x-oapi-codegen-extra-tags":{"validate":"required,gte=1"}}},"required":["slot","times"],"type":"object"},"DispenserSlot":{"description":"Dispenser slot number","example":1,"minimum":1,"type":"integer","x-oapi-codegen-extra-tags":{"validate":"required,gte=1"}},"DispenserSlotState":{"description":"Dispenser slot state","properties":{"enabled":{"example":true,"type":"boolean"},"slot":{"$ref":"#/components/schemas/DispenserSlot"}},"required":["slot","enabled"],"type":"object"},"DispenserSlotsResult":{"properties":{"state":{"items":{"$ref":"#/components/schemas/DispenserSlotState"},"type":"array"}},"required":["state"],"type":"object"},"ErrorResult":{"description":"Error","properties":{"code":{"description":"Error code","example":-1,"type":"integer"},"message":{"description":"Error description","example":"Some error description","type":"string"}},"required":["code","message"],"type":"object"},"EvalHydroAccepted":{"properties":{"acceptance":{"$ref":"#/components/schemas/ItemAcceptanceFlag"},"alloy":{"description":"Valuable metal","example":"au","type":"string"},"carat":{"description":"Fineness in carats","example":"14K","type":"string"},"confidence":{"description":"Evaluation confidence, 1.0 - is confident, 0.0 - is not, 0.8 - is 'pretty' confident","example":0.913,"format":"double","type":"number"},"millesimal":{"description":"Millesimal fineness, 585 stands for 58.5%, 999 for 99.9%, 9999 for 99.99%","example":585,"type":"integer"},"purity":{"description":"Content of the valuable metal in percents","example":58.5,"format":"double","type":"number"},"risky":{"description":"Automatic decision result","type":"boolean"},"warnings":{"description":"Warnings that should help with decision. For instance, there could be a tungsten covered with gold.","example":["tungsten_in_gold"],"items":{"type":"string"},"type":"array"},"weight":{"description":"Weight in grams","example":3.141,"format":"double","type":"number"}},"required":["acceptance","alloy","carat","confidence","millesimal","purity","risky","warnings","weight"],"type":"object"},"EvalHydroRejected":{"properties":{"acceptance":{"$ref":"#/components/schemas/ItemAcceptanceFlag"},"code":{"description":"Optional reason code as defined in evaluation rule","example":"not_enough_gold","type":"string"},"reason":{"$ref":"#/components/schemas/ItemRejectionReason"}},"required":["acceptance","reason","code"],"type":"object"},"EvalHydroResult":{"discriminator":{"mapping":{"accepted":"#/components/schemas/EvalHydroAccepted","rejected":"#/components/schemas/EvalHydroRejected"},"propertyName":"acceptance"},"oneOf":[{"$ref":"#/components/schemas/EvalHydroAccepted"},{"$ref":"#/components/schemas/EvalHydroRejected"}]},"EvalNewResult":{"properties":{"eval_id":{"description":"Evaluation ID","example":1337,"format":"uint64","type":"integer"},"storage_cell":{"$ref":"#/components/schemas/StorageCell"}},"required":["eval_id","storage_cell"],"type":"object"},"EvalSpectrumAccepted":{"description":"Item is accepted","properties":{"acceptance":{"$ref":"#/components/schemas/ItemAcceptanceFlag"},"alloy":{"description":"Valuable metal","example":"au","type":"string"},"carat":{"description":"Fineness in carats","example":"14K","type":"string"},"millesimal":{"description":"Millesimal fineness. 585 stands for 58.5%, 999 for 99.9%, 9999 for 99.99%","example":585,"type":"integer"},"purity":{"description":"Content of the valuable metal in percents","example":58.5,"format":"double","type":"number"},"spectrum":{"additionalProperties":{"format":"double","type":"number"},"description":"Spectrum data","example":{"au":58.5,"cu":14.2,"xx":0},"type":"object","x-go-type":"map[string]float64"}},"required":["acceptance","alloy","carat","millesimal","purity","spectrum"],"type":"object"},"EvalSpectrumRejected":{"description":"Item is rejected","properties":{"acceptance":{"$ref":"#/components/schemas/ItemAcceptanceFlag"},"code":{"description":"Optional reason code as defined in evaluation rule","example":"not_enough_gold","type":"string"},"reason":{"$ref":"#/components/schemas/ItemRejectionReason"}},"required":["acceptance","reason","code"],"type":"object"},"EvalSpectrumResult":{"description":"Item acceptance decision","discriminator":{"mapping":{"accepted":"#/components/schemas/EvalSpectrumAccepted","rejected":"#/components/schemas/EvalSpectrumRejected"},"propertyName":"acceptance"},"oneOf":[{"$ref":"#/components/schemas/EvalSpectrumAccepted"},{"$ref":"#/components/schemas/EvalSpectrumRejected"}]},"EvalStoreRequest":{"properties":{"user_tag":{"$ref":"#/components/schemas/StorageTag"}},"required":["user_tag"],"type":"object"},"EvalStoreResult":{"properties":{"cell":{"$ref":"#/components/schemas/StorageCell"},"hardware_failed":{"description":"In case of hardware failure this flag is set. You should complete current customer session and call `service.kill` method.\n\nAt this point any calls to the API methods are forbidden (except `hardware.*`).\n\nThe purpose of this workaround is to protect the hardware from a damage, while still allowing the business logic to remain intact.\n\nOn a failure, there is no guarantee that the item has been moved, but the business flow must complete for sake of data consistency. \n\nOne way or another, the item will be moved by technical support team.","example":false,"type":"boolean"}},"required":["cell","hardware_failed"],"type":"object"},"ItemAcceptanceFlag":{"enum":["accepted","rejected"],"example":"accepted","type":"string"},"ItemRejectionReason":{"description":"Reason why the item is rejected by the Goldex","enum":["undescribed","low_spectrum","low_weight","high_weight","unconfirmed"],"type":"string"},"ProxyRequest":{"properties":{"body":{"description":"Request key-value","example":{"foo":"bar"},"type":"object"},"endpoint":{"description":"Predefined endpoint name","example":"my-method","type":"string","x-oapi-codegen-extra-tags":{"validate":"required"}}},"required":["endpoint","body"],"type":"object"},"ProxyResult":{"properties":{"body":{"description":"Result key-value","example":{"foo":"bar"},"type":"object"},"http_status":{"description":"http status","example":200,"format":"int64","type":"integer"}},"required":["body","http_status"],"type":"object"},"ServiceArgs":{"description":"User defined args","example":"{\"foo\":\"bar\"}","type":"string"},"StatusResult":{"properties":{"bot_id":{"example":42,"format":"uint64","type":"integer"},"features":{"$ref":"#/components/schemas/StatusResultFeatures"},"online":{"description":"Online status","example":true,"type":"boolean"},"power":{"description":"Power line status","example":true,"type":"boolean"},"project_id":{"example":1,"format":"uint64","type":"integer"},"serial":{"description":"Machine serial number","example":"CB-001","type":"string"}},"required":["project_id","bot_id","serial","online","power","features"],"type":"object"},"StatusResultFeatures":{"description":"Describes the machine features","properties":{"has_dispenser":{"description":"Machine has coin/bar dispenser hardware (for shop business flow)","example":false,"type":"boolean"},"storage_can_extract":{"description":"Machine storage supports items extraction (for shop or pawnshop business flow)","example":true,"type":"boolean"}},"required":["storage_can_extract","has_dispenser"],"type":"object"},"StorageAllocatedCell":{"description":"Describes allocated storage cell","properties":{"cell":{"$ref":"#/components/schemas/StorageCell"},"user_tag":{"$ref":"#/components/schemas/StorageTag"}},"required":["cell","user_tag"],"type":"object"},"StorageCell":{"description":"Storage cell address","example":"A1","maxLength":4,"minLength":2,"type":"string","x-oapi-codegen-extra-tags":{"validate":"required,alphanum,min=2,max=4"}},"StorageExtractRequest":{"properties":{"cell":{"$ref":"#/components/schemas/StorageCell"}},"required":["cell"],"type":"object"},"StorageExtractResult":{"properties":{"cell":{"$ref":"#/components/schemas/StorageCell"},"hardware_failed":{"description":"In case of hardware failure this flag is set. You should complete current customer session and call `service.kill` method.\n\nAt this point any calls to the API methods are forbidden (except `hardware.*`).\n\nThe purpose of this workaround is to protect the hardware from a damage, while still allowing the business logic to remain intact.\n\nOn a failure, there is no guarantee that the item has been moved, but the business flow must complete for sake of data consistency. \n\nOne way or another, the item will be moved by technical support team.","example":false,"type":"boolean"}},"required":["cell","hardware_failed"],"type":"object"},"StorageStateResult":{"properties":{"allocated":{"description":"Allocated storage cells","items":{"$ref":"#/components/schemas/StorageAllocatedCell"},"type":"array"},"free":{"description":"Number of free storage cells","example":42,"type":"integer"}},"required":["allocated","free"],"type":"object"},"StorageTag":{"description":"Storage cell user tag","example":"{\"domain\":\"shop\"}","maxLength":4096,"type":"string","x-oapi-codegen-extra-tags":{"validate":"max=4096"}},"SubEvalPhotoUploadEvent":{"properties":{"eval_id":{"description":"Evaluation ID","example":1337,"format":"uint64","type":"integer"},"photo_ids":{"description":"Photo ID list","example":["dafc61a8277b44a3a8dedf197a862783"],"items":{"type":"string"},"type":"array"}},"required":["eval_id","photo_ids"],"type":"object"},"SubEvalPhotoUploadRequest":{"properties":{"subscribe":{"description":"Subscribe or unsubscribe to the event","example":true,"type":"boolean"}},"required":["subscribe"],"type":"object"}}},"info":{"description":"This document describes Goldex Robot [JSON-RPC 2.0](https://www.jsonrpc.org/specification) API in terms of HTTP requests, so:\n* method names should be read without a slash, i.e. `POST /foo.bar` is `foo.bar` method;\n* request bodies are treated as [request object params](https://www.jsonrpc.org/specification#request_object);\n* default response corresponds to the [response object result](https://www.jsonrpc.org/specification#response_object);\n* numeric response code represents [error object code](https://www.jsonrpc.org/specification#error_object);\n\nIn addition to standard [JSON-RPC error codes](https://www.jsonrpc.org/specification#error_object), each method defines local 5xx codes that should be handled.","title":"Bot (customer UI API)","version":"1.2.0"},"openapi":"3.0.0","paths":{"/dispenser.extract":{"post":{"description":"Requires hardware to extract items from the dispenser and bring them to the outlet window.\n\nOn completion, the outlet window will be opened with items inside.\n\nThe customer should have enough time to take items out of the window.\n\nThen `outlet.close` should be called to close the outlet window (we propose customer explicit action or a timeout).","operationId":"dispenserExtract","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DispenserExtractRequest"}}},"description":"Params"},"responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DispenserExtractResult"}}},"description":"Result"}},"summary":"Dispense items","tags":["dispenser"]}},"/dispenser.slots":{"post":{"operationId":"dispenserSlots","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DispenserSlotsResult"}}},"description":"Result"}},"summary":"Get dispenser slots state","tags":["dispenser"]}},"/eval.hydro":{"post":{"description":"Continues the item evaluation (hydrostatic phase).\n\nIf the item is **accepted**, it could be returned back to the customer with `eval.return`, or stored with `eval.store`.\n\nIf the item is **rejected**, then `eval.return` should be called.","operationId":"evalHydro","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"503":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Vibration affects the weighing process. Call `eval.return`"},"504":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Network is unavailable. Call `eval.return`"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EvalHydroResult"}}},"description":"Result"}},"summary":"(3) Hydrostatic evaluation","tags":["eval"]}},"/eval.new":{"post":{"description":"Prepares a new item evaluation. \n\nOn success, returns evaluation ID and preliminary storage cell address. Then `inlet.open` should be called.\n\nOn failure, the evaluation should be cancelled.","operationId":"evalNew","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"503":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Hardware is not ready yet. Do nothing"},"504":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Network is unavailable. Try again"},"507":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Storage is out of space. Do nothing"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EvalNewResult"}}},"description":"Result"}},"summary":"(1) Prepare evaluation","tags":["eval"]}},"/eval.return":{"post":{"description":"Starts a returning process of the item.\n\nOn completion, the outlet window will be opened with the item inside.\n\nThe customer should have enough time to take the item out of the window.\n\nThen `outlet.close` should be called to close the outlet window (we propose customer explicit action or a timeout).","operationId":"evalReturn","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"default":{"$ref":"#/components/responses/EmptyResult"}},"summary":"(4a) Return item","tags":["eval"]}},"/eval.spectrum":{"post":{"description":"Starts the item evaluation (spectral phase).\n\nIf the item is **accepted**, it could be returned back to the customer with `eval.return`, otherwise the evaluation should be continued with `eval.hydro`.\n\nIf the item is **rejected**, then `eval.return` should be called.","operationId":"evalSpectrum","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"504":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Network is unavailable. Call `eval.return`"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EvalSpectrumResult"}}},"description":"Result"}},"summary":"(2) Spectral evaluation","tags":["eval"]}},"/eval.store":{"post":{"description":"Requires hardware to carry the item to the machine storage.\n\nOn completion, returns the storage cell address where the item is stored.","operationId":"evalStore","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EvalStoreRequest"}}},"description":"Params"},"responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EvalStoreResult"}}},"description":"Result"}},"summary":"(4b) Store item","tags":["eval"]}},"/inlet.close":{"post":{"description":"Requires hardware to close the inlet window. \n\nOn completion, the `eval.spectrum` should be called to start prepared evaluation.","operationId":"inletClose","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"503":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Window is obstructed. Try one more time."},"default":{"$ref":"#/components/responses/EmptyResult"}},"summary":"Close inlet window","tags":["window"]}},"/inlet.open":{"post":{"description":"Requires hardware to open the inlet window. \n\nWhen ready, the customer should initiate the window closure with `inlet.close`.","operationId":"inletOpen","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"default":{"$ref":"#/components/responses/EmptyResult"}},"summary":"Open inlet window","tags":["window"]}},"/outlet.close":{"post":{"description":"Requires hardware to close the outlet window. \n\nA call to the `eval.return` or `storage.extract` automatically opens outlet window with the item inside.\n\nThe customer should have enough time to take the item out of the window.\n\nThen this method should be called to close the outlet window (we propose customer explicit action or a timeout).","operationId":"outletClose","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"503":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Window is obstructed. Try one more time."},"default":{"$ref":"#/components/responses/EmptyResult"}},"summary":"Close outlet window","tags":["window"]}},"/proxy":{"post":{"description":"Requires Goldex backend to sign and send an HTTP POST request to the business backend. \n\nEndpoint name and address should be known at the Goldex side before the call made (see Goldex backend API).","operationId":"proxyCall","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProxyRequest"}}},"description":"Params"},"responses":{"504":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResult"}}},"description":"Network is unavailable. Try again"},"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProxyResult"}}},"description":"Result"}},"summary":"Call business backend","tags":["business"]}},"/service.args":{"post":{"description":"Return the arguments of the GR core command which has been sent to show the UI.","operationId":"serviceArgs","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceArgs"}}},"description":"Result"}},"summary":"Get UI arguments","tags":["service"]}},"/service.kill":{"post":{"description":"Force the machine to show out of service page.\n\nCurrent UI will be unloaded.","operationId":"serviceKill","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"default":{"$ref":"#/components/responses/EmptyResult"}},"summary":"Kill the UI","tags":["service"]}},"/service.status":{"post":{"description":"Reports current online status and machine features","operationId":"serviceStatus","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StatusResult"}}},"description":"Result"}},"summary":"Machine status","tags":["service"]}},"/storage.extract":{"post":{"description":"Requires hardware to extract an item from the specified storage cell address and bring it to the outlet window.\n\nOn completion, the outlet window will be opened with the item inside, and the requested storage cell address will be returned.\n\nThe customer should have enough time to take the item out of the window.\n\nThen `outlet.close` should be called to close the outlet window (we propose customer explicit action or a timeout).","operationId":"storageExtract","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StorageExtractRequest"}}},"description":"Params"},"responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StorageExtractResult"}}},"description":"Result"}},"summary":"Extract item from storage","tags":["storage"]}},"/storage.state":{"post":{"description":"Reports machine storage state: allocated and free cell addresses","operationId":"storageState","requestBody":{"$ref":"#/components/requestBodies/EmptyRequest"},"responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StorageStateResult"}}},"description":"Result"}},"summary":"Storage state","tags":["storage"]}},"/storage.tag":{"post":{"operationId":"storageTag","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StorageAllocatedCell"}}},"description":"Params"},"responses":{"default":{"$ref":"#/components/responses/EmptyResult"}},"summary":"Set user tag for an allocated slot","tags":["storage"]}},"/sub.eval_photo_upload":{"get":{"operationId":"subEvalPhotoUploadEvent","responses":{"default":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubEvalPhotoUploadEvent"}}},"description":"Event"}},"summary":"Photo upload event","tags":["subscription"]},"post":{"description":"The API will send a notification when a photo is uploaded to the Goldex backend.","operationId":"subEvalPhotoUpload","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubEvalPhotoUploadRequest"}}},"description":"Params"},"responses":{"default":{"$ref":"#/components/responses/EmptyResult"}},"summary":"Subscribe/unsubscribe to eval photo events","tags":["subscription"]}}},"tags":[{"name":"service"},{"name":"eval"},{"name":"window"},{"name":"storage"},{"name":"dispenser"},{"name":"business"},{"name":"subscription"}]}